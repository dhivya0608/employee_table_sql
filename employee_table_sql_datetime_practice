/* =========================================================
   SQL PRACTICE QUESTIONS â€“ EMPLOYEES TABLE
   TABLE: employees
   ========================================================= */

/*----------------------------------------------------------
1. FIND THE EMPLOYEE NAME WHO JOINED AFTER 2021
----------------------------------------------------------*/
SELECT employee_name
FROM employees
WHERE joining_date > '2021-12-31';


/*----------------------------------------------------------
2. FIND THE SENIOR (LONGEST WORKING) EMPLOYEE IN THE COMPANY
----------------------------------------------------------*/
SELECT employee_name, joining_date
FROM employees
WHERE joining_date = (
    SELECT MIN(joining_date)
    FROM employees
);


/*----------------------------------------------------------
3. FIND THE EMPLOYEE WHO JOINED IN THE YEAR 2020 AND 2021
----------------------------------------------------------*/
SELECT employee_name, joining_date
FROM employees
WHERE YEAR(joining_date) IN (2020, 2021);


/*----------------------------------------------------------
4. FIND THE EMPLOYEE WORKING EXPERIENCE IN TERMS OF YEARS
----------------------------------------------------------*/
SELECT employee_name,
       TIMESTAMPDIFF(YEAR, joining_date, CURDATE()) AS experience_years
FROM employees;


/*----------------------------------------------------------
5. FIND THE YEAR IN WHICH THE HIGHEST NUMBER OF EMPLOYEES JOINED
----------------------------------------------------------*/
SELECT YEAR(joining_date) AS joining_year
FROM employees
GROUP BY YEAR(joining_date)
ORDER BY COUNT(*) DESC
LIMIT 1;


/*----------------------------------------------------------
6. FIND THE MONTH AND YEAR IN WHICH THE HIGHEST NUMBER
   OF EMPLOYEES JOINED
----------------------------------------------------------*/
SELECT YEAR(joining_date) AS joining_year,
       MONTH(joining_date) AS joining_month
FROM employees
GROUP BY YEAR(joining_date), MONTH(joining_date)
ORDER BY COUNT(*) DESC
LIMIT 1;
